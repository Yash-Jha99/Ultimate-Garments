import{r as i,a0 as q,w as I,j as e,$ as g,J as W,K as A,A as j,al as w,y as O,am as B,an as V,H as y,ao as $,ap as K,aq as U,W as _,ar as G,C as S,as as L}from"./index-41c74605.js";const J=()=>{const[v,p]=i.useState(!1),[k,T]=i.useState(!1),[f,x]=i.useState(!1),[c,b]=i.useState(0),[D,C]=i.useState(!1),[r,u]=i.useState({mobileNumber:!1,name:!1,email:!1,otp:!1}),[n,d]=i.useState({mobileNumber:"",otp:"",name:"",email:"",notify:!1}),N=q(),{enqueueSnackbar:z}=I(),F=()=>{b(0),d({mobileNumber:"",otp:"",name:"",email:"",notify:!1}),p(!1)},P=async()=>{const{mobileNumber:a}=n;if(a.trim()===""||a.trim().length!==10||isNaN(Number(a))){u({...r,mobileNumber:!0});return}C(!0);try{window.otpResult=await G(a);const t=await S("auth/login",{mobileNumber:a});if(t){const{isRegistered:s}=t.data;b(30),p(!0),T(!s)}}catch(t){console.log(t),z("Something went wrong...",{variant:"error"})}C(!1)},m=async a=>{const{name:t,value:s,checked:h}=a.target;if(r[t]=!1,x(null),t==="otp"&&s.length===6){d(o=>({...o,otp:s}));try{await window.otpResult.confirm(s);const o=await S("auth/validate",{otp:s,mobileNumber:n.mobileNumber});o.status===200&&(x(!0),o.data&&N(L({token:o.data})))}catch{x(!1)}}t==="mobileNumber"&&v&&(p(!1),d({...n,otp:"",name:"",email:""}));let l={[t]:s};t==="notify"&&(l={[t]:h}),d(o=>({...o,...l}))},E=async()=>{const{email:a,name:t,otp:s}=n;if(s.trim().length===0||!f)return u({...r,otp:!0});if(t.trim().length===0)return u({...r,name:!0});if(a.trim().length===0)return u({...r,email:!0});const h={...n};delete h.otp;const l=await S("user",h);if(l.status===400)return alert(l.data);N(L({token:l.data})),F()};i.useEffect(()=>{const a=setInterval(()=>{c>0?b(t=>t-1):clearInterval(a)},1e3);return()=>clearInterval(a)},[c]);const R=e.jsxs(e.Fragment,{children:[e.jsx(g,{error:r.name,color:"text",label:"Full Name",margin:"dense",required:!0,size:"small",fullWidth:!0,value:n.name,onChange:m,name:"name"}),e.jsx(g,{error:r.email,color:"text",type:"email",label:"Email Address",margin:"dense",required:!0,size:"small",fullWidth:!0,value:n.email,onChange:m,name:"email"}),e.jsx(W,{sx:{fontSize:"10px"},control:e.jsx(A,{color:"secondary",checked:n.notify,onChange:m,name:"notify"}),label:e.jsx(j,{variant:"body2",children:"Yes, Keep me posted with current offers, new arrivals, sale and contest"})})]});return e.jsx(w,{justifyContent:"center",alignItems:"center",height:"75vh",children:e.jsxs(O,{width:"40%",boxShadow:2,bgcolor:"white",textAlign:"center",pt:2,sx:{width:{xs:360,sm:440},mx:"auto"},children:[e.jsx(j,{variant:"h5",children:"Login/Sign Up to explore great designs"}),e.jsxs(B,{children:["Login / Signup",e.jsx("div",{style:{fontSize:12,fontWeight:"normal"},children:"Get Exciting Offers & Track Order"})]}),e.jsxs(V,{children:[e.jsx(g,{error:r.mobileNumber,color:"text",inputProps:{pattern:"[0-9]{10}",maxLength:10},label:"Phone Number",name:"mobileNumber",onChange:m,value:n.mobileNumber,margin:"dense",required:!0,size:"small",fullWidth:!0}),v?e.jsxs(w,{spacing:2,direction:"column",children:[!f&&e.jsx(O,{display:"flex",mb:-3,justifyContent:"flex-end",children:e.jsxs(y,{disabled:c!==0,onClick:P,color:"secondary",children:["Resend OTP",c!==0&&` in ${c} s`]})}),e.jsx(g,{error:r.otp,InputProps:{endAdornment:n.otp.length===6&&e.jsx($,{position:"end",children:f?e.jsx(K,{color:"success"}):e.jsx(U,{color:"error"})})},inputProps:{maxLength:6},color:"text",label:"Enter 6 Digit OTP",margin:"normal",size:"small",fullWidth:!0,value:n.otp,onChange:m,name:"otp"}),k&&R,e.jsx(y,{variant:"contained",sx:{bgcolor:"black",":hover":{bgcolor:"black"}},onClick:E,children:k?"Sign Up":"Verify"})]}):e.jsx(e.Fragment,{children:e.jsx(y,{sx:{mt:2,bgcolor:"black",":hover":{bgcolor:"black"}},variant:"contained",id:"sign-in-button",onClick:P,children:e.jsxs(w,{direction:"row",spacing:2,children:[D&&e.jsx(_,{size:20,color:"inherit"}),e.jsx(j,{whiteSpace:"nowrap",fontSize:14,children:"Login with OTP"})]})})})]})]})})};export{J as default};
