import{j as t,G as F,h as J,S as M,C as K,e as N,i as Q,k as X,a as _,l as z,m as Y,n as L,T as x,B as q,o as Z,P,M as E,r as u,u as $,q as ee,L as te,D as se,p as ae,t as re,v as ie}from"./index-e460f224.js";const ne=({formDetails:c,error:d,formLabels:i,onChange:a,onSave:f,onCancel:h})=>t.jsxs(t.Fragment,{children:[t.jsx(F,{p:2,container:!0,rowSpacing:3,columnSpacing:2,children:Object.keys(c).map((o,p)=>p<8?t.jsx(F,{item:!0,xs:12,sm:6,children:t.jsx(J,{error:d[o],color:"secondary",label:i[p],required:!0,size:"small",fullWidth:!0,value:c[o],onChange:a,name:o})},o):t.jsxs(M,{pt:2,direction:"row",alignItems:"center",children:[t.jsx("span",{children:t.jsx(K,{color:"secondary",checked:c.isDefault,onChange:a,name:"isDefault"})}),t.jsx("span",{children:"Make this my default address"})]},p))}),t.jsx(N,{sx:{mb:1},variant:"contained",fullWidth:!0,onClick:f,children:"Save"}),t.jsx(N,{color:"inherit",fullWidth:!0,onClick:h,children:"Cancel"})]});var S={},oe=X;Object.defineProperty(S,"__esModule",{value:!0});var W=S.default=void 0,de=oe(Q()),le=t,ce=(0,de.default)((0,le.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");W=S.default=ce;const ue=({activeAddressId:c,defaultAddressId:d,setActiveAddress:i,item:a,onEdit:f=null,onDelete:h=null})=>{const o=_(),p=z(),m=p.pathname==="/myaccount/address";return t.jsxs(Y,{variant:"outlined",sx:{cursor:"pointer",outline:c===a.id?"2px solid #03a9f4":"1px solid lightgray",padding:2,mb:2,position:"relative"},onClick:()=>{p.pathname==="/myaccount/address"||c===a.id||(i(a),o(L(a)))},children:[a.id===d&&t.jsx(x,{sx:{position:"absolute",bottom:0,right:0,bgcolor:"secondary.main",px:1,color:"white"},variant:"button",children:"Default"}),m&&t.jsx(q,{position:"absolute",top:0,right:0,children:t.jsx(Z,{overlap:!0,disableArrow:!0,position:"right",trigger:t.jsx(W,{}),children:t.jsxs(P,{children:[t.jsx(E,{sx:{display:"block",fontSize:14},onClick:()=>f(a.id),children:"Edit"}),a.id!==d&&t.jsx(E,{sx:{display:"block",fontSize:14},onClick:()=>h(a.id),children:"Delete"})]})})}),t.jsxs(x,{fontWeight:600,variant:"subtitle1",mb:1,children:[a.firstName," ",a.lastName," ","("+a.pincode+")"]}),t.jsxs(x,{variant:"body2",children:[a.address,", ",a.town]}),t.jsxs(x,{variant:"subtitle2",children:[a.city,", ",a.state," "]})]})},he=()=>{const[c,d]=u.useState(!1),[i,a]=u.useState([]),[f,h]=u.useState(""),[o,p]=u.useState(""),[m,j]=u.useState({}),[B,w]=u.useState(!0),[A,v]=u.useState({firstName:!1,lastName:!1,mobileNumber:!1,pincode:!1,town:!1,city:!1,state:!1,address:!1}),[n,g]=u.useState({firstName:"",lastName:"",mobileNumber:"",pincode:"",town:"",city:"",state:"",address:"",isDefault:!1}),R=["First Name","Last Name","Phone No.","PIN Code","Town/Village","City/District","State","Address (House No, Building, Street, Area)"],k=_(),b=z(),{deliveryAddress:y}=$(e=>e.checkout),T=e=>{const{name:s,value:l,checked:r}=e.target;A[s]=!1;let I={[s]:l};s==="isDefault"&&(I={[s]:r}),g(U=>({...U,...I}))},D=()=>{g({firstName:"",lastName:"",mobileNumber:"",pincode:"",town:"",city:"",state:"",address:"",isDefault:!1})},C=()=>{for(let e in n)if(e!=="isDefault"){if(e==="mobileNumber"&&(isNaN(n[e].trim())||n[e].trim().length!==10))return v(s=>({...s,[e]:!0})),!1;if(e==="pincode"&&(isNaN(n[e].trim())||n[e].trim().length!==6))return v(s=>({...s,[e]:!0})),!1;if(n[e].trim()==="")return v(s=>({...s,[e]:!0})),!1}return!0},V=async()=>{if(!C())return;const{status:e,data:s}=await ae("address",n);e===201&&(a([...i,{...n,id:s.id}]),h(s.id),d(!1),D())},G=async e=>{if(f===e)return;const s=[...i];a(i.filter(r=>r.id!==e));const{status:l}=await re("address/"+e);l!==200&&a(s)},O=async()=>{if(!C())return;console.log(n);const e=[...i],s=f;a(i.map(r=>r.id===o?{id:o,...n}:r)),n.isDefault&&h(o),d(!1);const{status:l}=await ie("address/"+o,n);l!==200&&(a(e),h(s)),D()},H=e=>{d(!0),p(e);const s={...i.find(l=>l.id===e)};e!==f&&(s.isDefault=!1),delete s.id,delete s.user_id,delete s.defaultAddressId,g(s)};return u.useEffect(()=>{(async()=>{w(!0);const e=await ee("address");if(w(!1),(e==null?void 0:e.length)!==0){const s=e.map(r=>({id:r.id,firstName:r.firstName,lastName:r.lastName,mobileNumber:r.mobileNumber,pincode:r.pincode,town:r.town,city:r.city,state:r.state,address:r.address}));a(s);const l=s.find(r=>r.id===e[0].user.defaultAddressId);h(e[0].user.defaultAddressId),!y&&b.pathname==="/checkout/shipping"?(j(l),k(L(l))):j(y)}})()},[y,k,b]),B?t.jsx(te,{}):t.jsxs(P,{sx:{p:2},elevation:2,children:[(c||i.length===0)&&t.jsx(ne,{formDetails:n,formLabels:R,error:A,onChange:T,onCancel:()=>d(!1),onSave:o?O:V}),t.jsx(q,{maxWidth:{xs:"100%",sm:"70%"},children:!c&&i.length!==0&&t.jsxs(t.Fragment,{children:[t.jsx(x,{mb:1,variant:"h5",children:b.pathname==="/checkout/shipping"?"Select Address":"Saved Addresses"}),t.jsx(se,{}),t.jsx(M,{mt:3,children:i.map((e,s)=>t.jsx(ue,{onDelete:G,onEdit:H,item:e,setActiveAddress:j,activeAddressId:m==null?void 0:m.id,defaultAddressId:f},s))}),t.jsx(N,{sx:{mt:2},variant:"contained",color:"secondary",onClick:()=>{d(!0),D()},children:"Add New"})]})})]})};export{he as default};
