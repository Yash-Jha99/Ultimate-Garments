import{E as A,G as W,j as e,v as E,S as n,A as s,s as H,r as f,x as I,a0 as M,t as N,w as D,W as U,y as x,a8 as V,a9 as B,aa as O,L as Y,ab as F,V as G,H as m,ac as K,ad as $,ae as J,af as Q,a7 as X,C as z,a1 as Z,ag as ee}from"./index-41c74605.js";var S={},te=W;Object.defineProperty(S,"__esModule",{value:!0});var T=S.default=void 0,se=te(A()),ne=e,ae=(0,se.default)((0,ne.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"}),"Payment");T=S.default=ae;const ie="/assets/shield-7e8d3e8f.svg",oe=({itemsCount:i,totalDiscount:a,totalAmount:c})=>{const h=E();return e.jsxs(n,{spacing:{xs:1,sm:2},children:[e.jsxs(s,{variant:"h6",borderBottom:"1px solid lightgray",pb:1,children:["PRICE DETAILS (",i," items)"]}),h.pathname==="/checkout/payment"?e.jsxs(n,{spacing:2,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Total Price"}),e.jsxs(s,{variant:"body2",children:["₹",c]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(n,{spacing:2,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Total MRP (Inc. of Taxes)"}),e.jsxs(s,{variant:"body2",children:["₹",c+a]})]}),e.jsxs(n,{spacing:2,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Discount"}),e.jsxs(s,{variant:"body2",children:["- ₹",a]})]})]}),e.jsxs(n,{spacing:2,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Shipping"}),e.jsx(s,{variant:"body2",children:"Free"})]}),e.jsxs(n,{spacing:2,direction:"row",borderTop:"1px solid lightgray",justifyContent:"space-between",pt:1,children:[e.jsx(s,{fontWeight:500,variant:"body1",children:h.pathname==="/checkout/payment"?"Amount Payable":"Total Amount"}),e.jsxs(s,{fontWeight:500,variant:"body1",children:["₹",c]})]}),e.jsxs(s,{variant:"body1",color:"white",bgcolor:"success.light",p:.5,textAlign:"center",children:["You Saved ₹",a," on this order"]})]})},re=H("div")(({theme:i,ownerState:a})=>({backgroundColor:i.palette.mode==="dark"?i.palette.grey[700]:"#ccc",zIndex:1,color:"#fff",width:36,height:36,display:"flex",borderRadius:"50%",justifyContent:"center",alignItems:"center",...a.active&&{background:i.palette.secondary.main,boxShadow:"0 4px 6px 0 rgba(0,0,0,.25)"},...a.completed&&{background:i.palette.secondary.main}}));function ce(i){const{active:a,completed:c,className:h}=i,j={1:e.jsx(Z,{fontSize:"small"}),2:e.jsx(ee,{fontSize:"small"}),3:e.jsx(T,{fontSize:"small"})};return e.jsx(re,{ownerState:{completed:c,active:a},className:h,children:j[String(i.icon)]})}const w=["/checkout/cart","/checkout/shipping","/checkout/payment"],le=()=>{const i=["My Cart","Address","Payment"],[a,c]=f.useState(0),[h,j]=f.useState(!1),{items:L,deliveryAddress:o,paymentMethod:b}=I(t=>t.checkout),{items:p,loading:P}=I(t=>t.cart),g=f.useRef(),y=E(),R=M(),u=N(),{enqueueSnackbar:v}=D();let d=L;y.pathname==="/checkout/cart"&&(d=p);const C=d.map(t=>t.price*t.quantity).reduce((t,l)=>t+l,0),_=d.map(t=>Math.ceil(t.price*t.discount/100)*t.quantity).reduce((t,l)=>t+l,0),k=async()=>{if(a===0){if(p.some(t=>t.quantityInStock===0))return v("Please remove out of stock item",{variant:"warning"});R(X(p)),u(w[1])}if(a===1){if(!o)return v("Please select a address",{variant:"warning"});u(w[2])}if(a===2){if(!b)return v("Please select a payment method",{variant:"warning"});const t={products:d.map(r=>({cartId:r.id,id:r.productId,price:r.price,quantity:r.quantity,optionId:r.product_option_id})),paymentType:b,addressId:o.id};j(!0);const l=await z("order",t);if(l.status===201)if(b==="Cash")u("/myaccount/orders/success");else{const r=await z("payment/create-checkout-session",{orderItemIds:l.data.orderItemIds.map(q=>q.id),orderId:l.data.orderId});r.status===200&&window.location.replace(r.data.url)}j(!1)}};return f.useEffect(()=>{c(w.indexOf(y.pathname))},[y.pathname]),h?e.jsx(U,{fullscreen:!0}):e.jsxs(x,{children:[e.jsx(V,{}),e.jsx(x,{position:"sticky",top:0,zIndex:100,children:e.jsx(x,{mx:8,height:"62px",bgcolor:"white",children:e.jsx(B,{component:"nav",color:"inherit",children:e.jsx(O,{sx:{display:"flex",justifyContent:"space-between"},children:e.jsxs(n,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",spacing:{xs:0,sm:4},mx:{xs:1,sm:5},children:[e.jsx(Y,{to:"/",children:e.jsx("img",{src:F,alt:"Ultimate Garments",width:80})}),e.jsxs(n,{width:{xs:170,sm:"initial"},direction:"row",alignItems:"center",spacing:1.5,children:[e.jsx("img",{width:50,src:ie,alt:""}),e.jsx(s,{fontWeight:500,fontSize:{xs:14,sm:24},variant:"h5",children:"100% SECURE PAYMENT"})]})]})})})})}),!P&&d.length===0&&p.length===0&&e.jsxs(x,{textAlign:"center",children:[e.jsx(G,{message:"Your cart is empty"}),e.jsx(m,{sx:{mt:-25},variant:"contained",size:"large",color:"secondary",onClick:()=>u("/"),children:"Start Shopping"})]}),(d.length!==0||p.length!==0)&&e.jsxs(e.Fragment,{children:[e.jsx(K,{sx:{mb:1,mt:2,mx:{xs:1,sm:8}},activeStep:a,alternativeLabel:!0,children:i.map(t=>e.jsx($,{children:e.jsx(J,{StepIconComponent:ce,children:t})},t))}),e.jsxs(n,{mx:{xs:0,sm:10},mb:{xs:1,sm:0},direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:6},alignItems:{xs:"center",sm:"flex-start"},justifyContent:"center",children:[e.jsx(n,{mb:{xs:0,sm:2},width:{xs:"100%",sm:"70%"},children:e.jsx(Q,{})}),e.jsxs(n,{spacing:{xs:1,sm:2},width:{xs:"95%",sm:"30%"},boxShadow:2,p:{xs:1,sm:3},bgcolor:"white",position:{xs:"static",sm:"sticky"},top:75,children:[y.pathname==="/checkout/payment"&&e.jsxs(x,{sx:{cursor:"pointer"},border:"1px solid lightgray",padding:2,children:[e.jsxs(n,{mb:1,justifyContent:"space-between",alignItems:"center",direction:"row",children:[e.jsx(s,{variant:"body1",children:"Deliver To:"}),e.jsx(m,{variant:"outlined",color:"secondary",size:"small",onClick:()=>u("/checkout/shipping"),children:"Change"})]}),e.jsxs(s,{fontWeight:500,variant:"subtitle1",mb:1,children:[o.firstName," ",o.lastName," ","("+o.pinCode+")"]}),e.jsxs(s,{variant:"body2",children:[o.address,", ",o.town,","," ",o.city,", ",o.state," "]}),e.jsx(s,{variant:"subtitle2",children:o.mobileNumber})]}),e.jsx(x,{ref:g,children:e.jsx(oe,{itemsCount:d.length,totalDiscount:_,totalAmount:C})}),e.jsx(m,{sx:{p:1,fontSize:20,display:{xs:"none",sm:"initial"}},variant:"contained",color:"secondary",fullWidth:!0,size:"large",onClick:k,children:"CHECKOUT SECURELY"})]})]}),e.jsxs(n,{bgcolor:"white",boxShadow:4,zIndex:20,direction:"row",justifyContent:"space-between",alignItems:"center",px:3,py:1,display:{xs:"flex",sm:"none"},position:"sticky",bottom:0,children:[e.jsxs(n,{justifyContent:"center",children:[e.jsxs(s,{lineHeight:1,fontWeight:500,fontSize:18,children:["₹",C]}),e.jsx(m,{sx:{p:0,fontWeight:400,fontSize:13,textTransform:"initial"},color:"secondary",onClick:()=>g==null?void 0:g.current.scrollIntoView({behaviour:"smooth",block:"start"}),children:"View price details"})]}),e.jsx(m,{variant:"contained",color:"secondary",size:"large",onClick:k,children:"CHECKOUT SECURELY"})]})]})]})};export{le as default};
