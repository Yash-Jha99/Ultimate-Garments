import{G as W,H,j as e,v as T,S as n,A as s,K as z,s as M,r as f,x as E,a1 as N,t as U,w as O,y as u,a9 as V,X as Y,l as w,aa as B,ab as F,L as G,ac as K,W as $,J as m,ad as J,ae as X,af as Q,ag as Z,a8 as ee,D as P,a2 as te,ah as se}from"./index-4c215e85.js";var S={},ne=H;Object.defineProperty(S,"__esModule",{value:!0});var L=S.default=void 0,ae=ne(W()),ie=e,re=(0,ae.default)((0,ie.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"}),"Payment");L=S.default=re;const oe="/assets/shield-7e8d3e8f.svg",ce="/assets/empty-cart-a2175a2f.png",de=({itemsCount:i,totalDiscount:a,totalAmount:c})=>{const h=T();return e.jsxs(n,{spacing:{xs:1,sm:1.5},children:[e.jsxs(s,{variant:"h6",children:["PRICE DETAILS (",i," items)"]}),e.jsx(z,{}),h.pathname==="/checkout/payment"?e.jsxs(n,{spacing:2,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Total Price"}),e.jsxs(s,{variant:"body2",children:["₹",c]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(n,{spacing:1,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Total MRP (Inc. of Taxes)"}),e.jsxs(s,{variant:"body2",children:["₹",c+a]})]}),e.jsxs(n,{spacing:2,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Discount"}),e.jsxs(s,{variant:"body2",children:["- ₹",a]})]})]}),e.jsxs(n,{spacing:2,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{variant:"body2",children:"Shipping"}),e.jsx(s,{variant:"body2",children:"Free"})]}),e.jsx(z,{}),e.jsxs(n,{spacing:1,direction:"row",justifyContent:"space-between",children:[e.jsx(s,{fontWeight:500,variant:"body1",children:h.pathname==="/checkout/payment"?"Amount Payable":"Total Amount"}),e.jsxs(s,{fontWeight:500,variant:"body1",children:["₹",c]})]}),e.jsxs(s,{variant:"body1",bgcolor:"success.light",p:.5,textAlign:"center",children:["You Saved ₹",a," on this order"]})]})},le=M("div")(({theme:i,ownerState:a})=>({backgroundColor:i.palette.mode==="dark"?i.palette.grey[700]:"#ccc",zIndex:1,color:"#fff",width:36,height:36,display:"flex",borderRadius:"50%",justifyContent:"center",alignItems:"center",...a.active&&{background:i.palette.secondary.main,boxShadow:"0 4px 6px 0 rgba(0,0,0,.25)"},...a.completed&&{background:i.palette.secondary.main}}));function he(i){const{active:a,completed:c,className:h}=i,j={1:e.jsx(te,{fontSize:"small"}),2:e.jsx(se,{fontSize:"small"}),3:e.jsx(L,{fontSize:"small"})};return e.jsx(le,{ownerState:{completed:c,active:a},className:h,children:j[String(i.icon)]})}const C=["/checkout/cart","/checkout/shipping","/checkout/payment"],pe=()=>{const i=["My Cart","Address","Payment"],[a,c]=f.useState(0),[h,j]=f.useState(!1),{items:R,deliveryAddress:r,paymentMethod:v}=E(t=>t.checkout),{items:x,loading:_}=E(t=>t.cart),g=f.useRef(),y=T(),q=N(),p=U(),{enqueueSnackbar:b}=O();let d=R;y.pathname==="/checkout/cart"&&(d=x);const k=d.map(t=>t.price*t.quantity).reduce((t,l)=>t+l,0),A=d.map(t=>Math.ceil(t.price*t.discount/100)*t.quantity).reduce((t,l)=>t+l,0),I=async()=>{if(a===0){if(x.some(t=>t.quantityInStock===0))return b("Please remove out of stock item",{variant:"warning"});q(ee(x)),p(C[1])}if(a===1){if(!r)return b("Please select a address",{variant:"warning"});p(C[2])}if(a===2){if(!v)return b("Please select a payment method",{variant:"warning"});const t={products:d.map(o=>({cartId:o.id,id:o.productId,price:o.price,quantity:o.quantity,optionId:o.product_option_id})),paymentType:v,addressId:r.id};j(!0);const l=await P("order",t);if(l.status===201)if(v==="Cash")p("/myaccount/orders/success");else{const o=await P("payment/create-checkout-session",{orderItemIds:l.data.orderItemIds.map(D=>D.id),orderId:l.data.orderId});o.status===200&&window.location.replace(o.data.url)}j(!1)}};return f.useEffect(()=>{c(C.indexOf(y.pathname))},[y.pathname]),e.jsxs(u,{children:[e.jsx(V,{}),h&&e.jsx(Y,{fullscreen:!0}),e.jsx(u,{position:"sticky",top:0,zIndex:100,height:"62px",children:e.jsx(w,{sx:{mx:8},children:e.jsx(B,{component:"nav",color:"inherit",children:e.jsx(F,{sx:{display:"flex",justifyContent:"space-between"},children:e.jsxs(n,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",spacing:{xs:0,sm:4},mx:{xs:1,sm:5},children:[e.jsx(G,{to:"/",children:e.jsx("img",{src:K,alt:"Ultimate Garments",width:80})}),e.jsxs(n,{width:{xs:170,sm:"initial"},direction:"row",alignItems:"center",spacing:1.5,children:[e.jsx("img",{width:50,src:oe,alt:""}),e.jsx(s,{fontWeight:500,fontSize:{xs:14,sm:24},variant:"h5",children:"100% SECURE PAYMENT"})]})]})})})})}),!_&&d.length===0&&x.length===0&&e.jsxs(u,{textAlign:"center",children:[e.jsx($,{message:"Your cart is empty",image:ce}),e.jsx(m,{sx:{mt:-25},variant:"contained",size:"large",color:"secondary",onClick:()=>p("/"),children:"Start Shopping"})]}),(d.length!==0||x.length!==0)&&e.jsxs(e.Fragment,{children:[e.jsx(J,{sx:{mb:1,mt:2,mx:{xs:1,sm:8}},activeStep:a,alternativeLabel:!0,children:i.map(t=>e.jsx(X,{children:e.jsx(Q,{StepIconComponent:he,children:t})},t))}),e.jsxs(n,{mx:{xs:0,sm:10},mb:{xs:1,sm:0},direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:6},alignItems:{xs:"center",sm:"flex-start"},justifyContent:"center",children:[e.jsx(n,{mb:{xs:0,sm:2},width:{xs:"100%",sm:"70%"},children:e.jsx(Z,{})}),e.jsx(w,{sx:{width:{xs:"100%",sm:"30%"}},children:e.jsxs(n,{spacing:{xs:1,sm:2},p:{xs:1,sm:3},position:{xs:"static",sm:"sticky"},top:75,children:[y.pathname==="/checkout/payment"&&e.jsxs(u,{sx:{cursor:"pointer"},border:"1px solid lightgray",padding:2,children:[e.jsxs(n,{mb:1,justifyContent:"space-between",alignItems:"center",direction:"row",children:[e.jsx(s,{variant:"body1",children:"Deliver To:"}),e.jsx(m,{variant:"outlined",color:"secondary",size:"small",onClick:()=>p("/checkout/shipping"),children:"Change"})]}),e.jsxs(s,{fontWeight:500,variant:"subtitle1",mb:1,children:[r.firstName," ",r.lastName," ","("+r.pinCode+")"]}),e.jsxs(s,{variant:"body2",children:[r.address,", ",r.town,","," ",r.city,", ",r.state," "]}),e.jsx(s,{variant:"subtitle2",children:r.mobileNumber})]}),e.jsx(u,{ref:g,children:e.jsx(de,{itemsCount:d.length,totalDiscount:A,totalAmount:k})}),e.jsx(m,{sx:{p:1,fontSize:20,display:{xs:"none",sm:"initial"}},variant:"contained",color:"secondary",fullWidth:!0,size:"large",onClick:I,children:"CHECKOUT SECURELY"})]})})]}),e.jsx(w,{sx:{position:"fixed",width:"100vw",bottom:0,display:{xs:"flex",sm:"none"}},elevation:4,children:e.jsxs(n,{zIndex:20,direction:"row",justifyContent:"space-between",alignItems:"center",px:2,pt:1,pb:2,width:"100%",position:"sticky",bottom:0,children:[e.jsxs(n,{justifyContent:"center",children:[e.jsxs(s,{lineHeight:1,fontWeight:500,fontSize:18,children:["₹",k]}),e.jsx(m,{sx:{p:0,fontWeight:400,fontSize:13,textTransform:"initial"},color:"secondary",onClick:()=>g==null?void 0:g.current.scrollIntoView({behaviour:"smooth",block:"start"}),children:"View price details"})]}),e.jsx(m,{variant:"contained",color:"secondary",size:"large",onClick:I,children:"CHECKOUT SECURELY"})]})})]})]})};export{pe as default};
